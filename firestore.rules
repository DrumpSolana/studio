rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // --- Businesses/Users Rules ---
    // A user can create a document for themselves, and only they can
    // read, update, or delete their own document.
    match /businesses/{businessId} {
      allow create: if request.auth != null && request.auth.uid == businessId;
      allow read, update, delete: if request.auth != null && request.auth.uid == businessId;
    }

    // --- Pre-orders Rules ---
    // Anyone (signed-in or not) can create a pre-order.
    // No one can read, update, or delete pre-orders to protect privacy.
    match /pre-orders/{orderId} {
      allow create: if true;
      allow read, update, delete: if false;
    }
  }
}
